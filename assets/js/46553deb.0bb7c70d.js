"use strict";(self.webpackChunkrifflab_docs=self.webpackChunkrifflab_docs||[]).push([[765],{907:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>n,metadata:()=>a,toc:()=>u});var o=r(5893),s=r(1151);const n={sidebar_position:4},i="Your first cluster",a={id:"build/groundwork/your-first-cluster",title:"Your first cluster",description:"Let's assume you went through the previous steps and now are ready to create your first cluster. This is simple enough to do pretty easily!",source:"@site/docs/build/groundwork/your-first-cluster.md",sourceDirName:"build/groundwork",slug:"/build/groundwork/your-first-cluster",permalink:"/docs/build/groundwork/your-first-cluster",draft:!1,unlisted:!1,editUrl:"https://github.com/riffcc/rifflabs/tree/main/packages/create-docusaurus/templates/shared/docs/build/groundwork/your-first-cluster.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"buildSidebar",previous:{title:"The first server",permalink:"/docs/build/groundwork/the-first-server"},next:{title:"Setting up Gravity (DHCP + DNS)",permalink:"/docs/build/groundwork/dns-dhcp"}},l={},u=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Plug in your new servers",id:"plug-in-your-new-servers",level:2},{value:"But wait, I&#39;m out of network ports!",id:"but-wait-im-out-of-network-ports",level:3},{value:"Enter, IPMI",id:"enter-ipmi",level:2},{value:"Installing Proxmox, again",id:"installing-proxmox-again",level:2},{value:"Creating your first cluster",id:"creating-your-first-cluster",level:2},{value:"Credits",id:"credits",level:2}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",ul:"ul",...(0,s.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h1,{id:"your-first-cluster",children:"Your first cluster"}),"\n",(0,o.jsx)(t.p,{children:"Let's assume you went through the previous steps and now are ready to create your first cluster. This is simple enough to do pretty easily!"}),"\n",(0,o.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"First server set up with Proxmox VE"}),"\n",(0,o.jsx)(t.li,{children:"Login credentials for the first server"}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"plug-in-your-new-servers",children:"Plug in your new servers"}),"\n",(0,o.jsx)(t.p,{children:'You\'ll need at least three Proxmox servers to form something called "quorum", where at least two out of three nodes agree on the state of a particular cluster. This allows for a cluster to continue operating even if one node goes down. (Two node clusters are "possible", but very much not recommended.)'}),"\n",(0,o.jsx)(t.p,{children:"Plug in your new servers. You can use the same process as you did for the first server."}),"\n",(0,o.jsx)(t.h3,{id:"but-wait-im-out-of-network-ports",children:"But wait, I'm out of network ports!"}),"\n",(0,o.jsx)(t.p,{children:"If your router is a consumer router, it might not have very many network ports. You might not have enough ports to plug all your computers and servers in! This is where a switch comes in handy. A switch is a device that allows you to plug in multiple devices and connect them to the same network. You can get a switch for pretty cheap, and it's a great way to expand your network."}),"\n",(0,o.jsx)(t.p,{children:"You should aim for a 10gbps or better switch if you can afford it. If you can't, a 1gbps switch will work just fine. If you purchase a 10gbps switch, make sure you also purchase 10gbps network adapters or purchase servers that have built in 10gbps networking to keep things even simpler."}),"\n",(0,o.jsx)(t.p,{children:"10gbps networking is strongly recommended for things such as Ceph and SeaweedFS, which we'll touch on later."}),"\n",(0,o.jsx)(t.p,{children:"You'll connect your router to your switch via one of your router's Ethernet ports, and then connect your servers to the switch. You can also connect your desktops and other devices to the switch. This is called a \"star\" topology, and is the most common way to set up a network."}),"\n",(0,o.jsx)(t.h2,{id:"enter-ipmi",children:"Enter, IPMI"}),"\n",(0,o.jsx)(t.p,{children:"IPMI is a protocol that allows you to remotely control a server, even if it's powered off. It's a great way to manage servers remotely, and is a great form of remote management. (There's also Redfish, a newer way to do roughly the same thing, but we won't go into that today)."}),"\n",(0,o.jsx)(t.p,{children:"You'll usually find the IPMI credentials for your servers on the packaging, or on the server itself. Once you've plugged in your servers into both power and networking, you'll find they likely automatically come online via IPMI!"}),"\n",(0,o.jsxs)(t.p,{children:["Navigate to your router's DHCP leases section (usually somewhere like ",(0,o.jsx)(t.a,{href:"http://10.1.1.1",children:"http://10.1.1.1"})," or ",(0,o.jsx)(t.a,{href:"http://192.168.1.1",children:"http://192.168.1.1"}),") and look for the IP addresses of your new servers. You'll want to find a MAC address matching the one that was on your server's label or packaging, and then look for the IP address that was assigned to it. You can then navigate to that IP address in your web browser and log in with the credentials you found on the label or packaging, such as ",(0,o.jsx)(t.a,{href:"https://10.1.50.1",children:"https://10.1.50.1"}),"."]}),"\n",(0,o.jsx)(t.p,{children:"Once you've logged in, you'll be greeted with a screen that looks something like this:"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"An example of an IPMI interface.",src:r(8734).Z+"",width:"1431",height:"1039"})}),"\n",(0,o.jsx)(t.h2,{id:"installing-proxmox-again",children:"Installing Proxmox, again"}),"\n",(0,o.jsx)(t.p,{children:"Log into the IPMI device for each of your servers and ensure that they're all powered on. If they're not, power them on, and navigate to the \"KVM\" section of the IPMI interface. You should be able to see the console of your server, and you should also be able to share a local ISO file (your copy of the Proxmox installer) with the remote server, saving you from even having to plug in a thumbdrive!"}),"\n",(0,o.jsx)(t.p,{children:"Follow the same steps you did before to install Proxmox on your new servers. Once you've done that, you'll be ready to create your first cluster. Note that while the installation of a Proxmox cluster is not automated, you'll only have to do it once, and it's a fairly simple process. From here on out, almost everything we plan to do will be largely automated, with the eventual goal of an entirely self-healing cluster."}),"\n",(0,o.jsxs)(t.p,{children:["We suggest you use the same root password - ideally a secure one such as those generated by a password manager - for all your servers, to make things easier, but if you want to go one step further you can generate unique passwords for each. We'll largely be using something called an ",(0,o.jsx)(t.code,{children:"ssh key"})," to log into our servers, which we'll cover shortly, so you won't actually be using your passwords very often either way."]}),"\n",(0,o.jsx)(t.p,{children:"SSH keys are highly recommended (or SSH certificates, which are even better) for connecting to your servers, as they allow you to log in without a password, and are much more secure than passwords alone, especially when combined with a secret passphrase."}),"\n",(0,o.jsx)(t.h2,{id:"creating-your-first-cluster",children:"Creating your first cluster"}),"\n",(0,o.jsx)(t.p,{children:"Go to the web interface for your first node, and under Datacenter -> Cluster, click on Create Cluster and give your new cluster a name."}),"\n",(0,o.jsx)(t.p,{children:"Then, go to Datacenter -> Cluster, and click on Join Information. Copy the information from the first node into the remaining nodes, and click Join Cluster. Repeat this process for all nodes."}),"\n",(0,o.jsx)(t.p,{children:"Once you're all done, you'll end up with this - your first Proxmox cluster."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"A picture of a Proxmox cluster.",src:r(8696).Z+"",width:"1421",height:"791"})}),"\n",(0,o.jsx)(t.p,{children:"Congratulations! You've just created your first Proxmox cluster. From here on out, we'll be using this cluster to create the rest of our lab."}),"\n",(0,o.jsx)(t.h2,{id:"credits",children:"Credits"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["Images for this page taken from ",(0,o.jsx)(t.a,{href:"https://pve.proxmox.com/wiki/Cluster_Manager",children:"https://pve.proxmox.com/wiki/Cluster_Manager"})]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8734:(e,t,r)=>{r.d(t,{Z:()=>o});const o=r.p+"assets/images/ipmi-77d2904fecf4b9e1b0505e9b5c11f5b8.png"},8696:(e,t,r)=>{r.d(t,{Z:()=>o});const o=r.p+"assets/images/proxmox-cluster-a53625bbf8f12c43c076dc7f2c2fe066.png"},1151:(e,t,r)=>{r.d(t,{Z:()=>a,a:()=>i});var o=r(7294);const s={},n=o.createContext(s);function i(e){const t=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(n.Provider,{value:t},e.children)}}}]);